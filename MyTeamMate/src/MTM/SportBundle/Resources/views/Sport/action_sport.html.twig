{% extends 'MTMSportBundle::base_sport.html.twig' %}

{% block body %}

	{% block div %}
		<div class="add_sport">
			{% if action == 'edit_sport' %}
				<form action="{{ path(action,{"idpractice" : idpractice}) }}" method="post" name="sport_form">
			{% else %}
				<form action="{{ path(action) }}" method="post" name="sport_form" >
			{% endif %}
			<div class="sport_info">
				<h3>Sport</h3>
				{{ form_widget(form.idsport) }}
			</div>
			<div class="sport_info lieu">
		   		<h3>Lieu</h3>
		   		{{ form_widget(form.idplace) }}
	   		</div>
	   		<div class="sport_info">
				<h3>Niveau</h3>
				{{ form_widget(form.idlevel) }}
			</div>
			<div class="sport_slots">
				<h3>Créneaux</h3>
				<ul class="slots" data-prototype="{{ form_widget(form.idslots.vars.prototype)|e }}" >
		    		{% for slot in form.idslots  %}	
			         	<li id="slot" >{{ form_widget(slot) }}</li>
			    	{% endfor %}
				</ul>
			</div>
			{{ form_rest(form) }}
			<div class="registrationSubmit" onclick="document.forms['sport_form'].submit()">
				<div class="registrationSubmitInner"  style="text-align: center">
			 	   	<span class="icon">
			 	   		{% if action == 'edit_sport' %}
			    			<input value="Modifier" type="submit" />			
						{% else %}
						    <input value="Ajouter" type="submit" />
						{% endif %}
					</span>
				</div>
			</div>
			
			</form>		
			<div id="map-canvas" ></div>
		</div>
	{% endblock %}
		<script src="{{ asset('bundles/mtmsport/js/addSlot.js') }}" type="text/javascript" ></script>
		<script type="text/javascript">
		<!--
		function initialize() {
			
			var input = (document.getElementById('practice_idplace_address'));
			var autocomplete = new google.maps.places.Autocomplete(input);

			google.maps.event.addListener(autocomplete, 'place_changed', function() {})
	  			
		}
		google.maps.event.addDomListener(window, 'load', initialize);
		
		var collectionHolder = $('ul.slots');
		
		// setup an "add a tag" link
		var $addSlotLink = $('<a href="#" class="add_slot_link">Ajouter un créneau</a>');
		var $newLinkLi = $('<li></li>').append($addSlotLink);	

		
		jQuery(document).ready(function() {
			
		    // add the "add a slot" anchor and li to the slots ul
		    collectionHolder.append($newLinkLi);
		
		    // count the current form inputs we have (e.g. 2), use that as the new
		    // index when inserting a new item (e.g. 2)
		    collectionHolder.data('index', collectionHolder.find(':input').length);
		
		    $addSlotLink.on('click', function(e) {
		        // prevent the link from creating a "#" on the URL
		        e.preventDefault();
		
		        // add a new tag form (see next code block)
		        addSlotForm(collectionHolder,$newLinkLi);
			    
		        
		    });
		 	// ajoute un lien de suppression √† tous les √©l√©ments li de
		    // formulaires de tag existants
			collectionHolder.find('li#slot').each(function() {
		        addSlotFormDeleteLink($(this));
		    });
		    
		});
		//-->
		</script>
		
{% endblock %}
